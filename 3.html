<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>150問 まるばつ記録アプリ</title>
    <!-- Tailwind CSSを読み込みます -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- 見やすいフォントを読み込みます -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Noto+Sans+JP:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        /* フォント設定 */
        body {
            font-family: 'Inter', 'Noto Sans JP', sans-serif;
        }
        /* ○ボタンが選択されたときのスタイル */
        .btn-selected-maru {
            background-color: #3b82f6 !important; /* blue-500 */
            color: white !important;
            border-color: #3b82f6 !important;
            transform: scale(1.1);
        }
        /* ×ボタンが選択されたときのスタイル */
        .btn-selected-batsu {
            background-color: #ef4444 !important; /* red-500 */
            color: white !important;
            border-color: #ef4444 !important;
            transform: scale(1.1);
        }
    </style>
</head>
<body class="bg-gray-100 text-gray-800">

    <!-- ▼▼▼ 変更点1: 左右の余白(padding)を少し減らしました (p-4 -> px-2 py-4) ▼▼▼ -->
    <div class="container mx-auto px-2 py-4 sm:p-6 lg:p-8 max-w-5xl">
        <!-- ヘッダー -->
        <header class="text-center mb-6">
            <h1 class="text-3xl sm:text-4xl font-bold text-gray-900">150問 まるばつ記録アプリ</h1>
            <p class="mt-2 text-gray-600">各問題に3つずつ、まる(○)かばつ(×)を記録できます。</p>
        </header>

        <!-- リセットボタンエリア -->
        <div id="reset-area" class="text-center mb-6 p-4 bg-white rounded-lg shadow">
            <!-- 通常のボタン -->
            <button id="reset-btn" class="bg-red-600 text-white font-bold py-2 px-6 rounded-lg shadow-md hover:bg-red-700 transition-all duration-300 active:scale-95">
                全記録をリセット
            </button>
            <!-- 確認用UI (最初は非表示) -->
            <div id="reset-confirm" class="hidden">
                <p class="text-gray-800 font-semibold mb-3">本当にリセットしますか？</p>
                <div class="flex justify-center gap-4">
                    <button id="cancel-reset-btn" class="bg-gray-500 text-white font-bold py-2 px-6 rounded-lg hover:bg-gray-600 transition-colors">
                        キャンセル
                    </button>
                    <button id="confirm-reset-btn" class="bg-red-600 text-white font-bold py-2 px-6 rounded-lg hover:bg-red-700 transition-colors">
                        はい、リセットします
                    </button>
                </div>
            </div>
        </div>


        <main>
            <!-- 問題表示エリア -->
            <div id="quiz-container" class="flex flex-col gap-2">
                <!-- 150問分の問題がここにJavaScriptで生成されます -->
            </div>
        </main>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const TOTAL_QUESTIONS = 150;
            let answers = Array.from({ length: TOTAL_QUESTIONS }, () => ({ answer1: null, answer2: null, answer3: null }));

            // HTML要素を取得
            const quizContainer = document.getElementById('quiz-container');
            const resetBtn = document.getElementById('reset-btn');
            const resetConfirmDiv = document.getElementById('reset-confirm');
            const confirmResetBtn = document.getElementById('confirm-reset-btn');
            const cancelResetBtn = document.getElementById('cancel-reset-btn');


            /**
             * 150問分の問題カードを生成して表示する関数
             */
            function createQuiz() {
                let quizHTML = '';
                for (let i = 0; i < TOTAL_QUESTIONS; i++) {
                    quizHTML += `
                        <div class="bg-white p-2 sm:p-3 rounded-lg shadow flex items-center" data-question-card="${i}">
                            <!-- ▼▼▼ 変更点2: 問題番号の幅を詰めました (w-16 -> w-14) ▼▼▼ -->
                            <p class="font-bold text-base text-gray-700 w-14 shrink-0">Q. ${i + 1}</p>
                            <div class="flex-grow grid grid-cols-3 gap-1 sm:gap-2">
                                <!-- 1セット目 -->
                                <div class="flex justify-center gap-2 sm:gap-3" data-set-container="1">
                                    <button class="answer-btn w-10 h-10 sm:w-12 sm:h-12 rounded-full border-2 border-blue-400 text-blue-500 font-bold text-xl transition-all duration-200 hover:bg-blue-100" data-question="${i}" data-answer="○" data-set="1">○</button>
                                    <button class="answer-btn w-10 h-10 sm:w-12 sm:h-12 rounded-full border-2 border-red-400 text-red-500 font-bold text-xl transition-all duration-200 hover:bg-red-100" data-question="${i}" data-answer="×" data-set="1">×</button>
                                </div>
                                <!-- 2セット目 -->
                                <div class="flex justify-center gap-2 sm:gap-3" data-set-container="2">
                                    <button class="answer-btn w-10 h-10 sm:w-12 sm:h-12 rounded-full border-2 border-blue-400 text-blue-500 font-bold text-xl transition-all duration-200 hover:bg-blue-100" data-question="${i}" data-answer="○" data-set="2">○</button>
                                    <button class="answer-btn w-10 h-10 sm:w-12 sm:h-12 rounded-full border-2 border-red-400 text-red-500 font-bold text-xl transition-all duration-200 hover:bg-red-100" data-question="${i}" data-answer="×" data-set="2">×</button>
                                </div>
                                <!-- 3セット目 -->
                                <div class="flex justify-center gap-2 sm:gap-3" data-set-container="3">
                                    <button class="answer-btn w-10 h-10 sm:w-12 sm:h-12 rounded-full border-2 border-blue-400 text-blue-500 font-bold text-xl transition-all duration-200 hover:bg-blue-100" data-question="${i}" data-answer="○" data-set="3">○</button>
                                    <button class="answer-btn w-10 h-10 sm:w-12 sm:h-12 rounded-full border-2 border-red-400 text-red-500 font-bold text-xl transition-all duration-200 hover:bg-red-100" data-question="${i}" data-answer="×" data-set="3">×</button>
                                </div>
                            </div>
                        </div>
                    `;
                }
                quizContainer.innerHTML = quizHTML;
            }

            /**
             * ○×ボタンがクリックされたときの処理（トグル機能を追加）
             * @param {Event} event - クリックイベント
             */
            function handleAnswerClick(event) {
                const target = event.target;
                if (!target.classList.contains('answer-btn')) return;

                const questionIndex = parseInt(target.dataset.question, 10);
                const newAnswer = target.dataset.answer;
                const setIndex = target.dataset.set;
                
                const answerKey = `answer${setIndex}`;
                const currentAnswer = answers[questionIndex][answerKey];

                const setContainer = target.closest('[data-set-container]');
                const buttonsInSet = setContainer.querySelectorAll('.answer-btn');

                if (currentAnswer === newAnswer) {
                    answers[questionIndex][answerKey] = null;
                    target.classList.remove('btn-selected-maru', 'btn-selected-batsu');
                } 
                else {
                    answers[questionIndex][answerKey] = newAnswer;
                    
                    buttonsInSet.forEach(btn => {
                        btn.classList.remove('btn-selected-maru', 'btn-selected-batsu');
                    });

                    if (newAnswer === '○') {
                        target.classList.add('btn-selected-maru');
                    } else {
                        target.classList.add('btn-selected-batsu');
                    }
                }
            }

            /**
             * リセット確認UIの表示を切り替える
             */
            function toggleResetConfirmation(show) {
                if(show) {
                    resetBtn.classList.add('hidden');
                    resetConfirmDiv.classList.remove('hidden');
                } else {
                    resetBtn.classList.remove('hidden');
                    resetConfirmDiv.classList.add('hidden');
                }
            }
            
            /**
             * 全ての記録をリセットする関数（ページリロードなし）
             */
            function resetAllRecords() {
                answers = Array.from({ length: TOTAL_QUESTIONS }, () => ({ answer1: null, answer2: null, answer3: null }));

                const allAnswerButtons = quizContainer.querySelectorAll('.answer-btn');
                allAnswerButtons.forEach(btn => {
                    btn.classList.remove('btn-selected-maru', 'btn-selected-batsu');
                });

                toggleResetConfirmation(false);
            }


            // --- イベントリスナーの設定 ---
            quizContainer.addEventListener('click', handleAnswerClick);
            
            resetBtn.addEventListener('click', () => toggleResetConfirmation(true));

            cancelResetBtn.addEventListener('click', () => toggleResetConfirmation(false));

            confirmResetBtn.addEventListener('click', resetAllRecords);

            // --- 初期化処理の呼び出し ---
            createQuiz();
        });
    </script>
</body>
</html>
